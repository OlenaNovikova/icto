<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Proto-Sphere with Torus - MindAR Scene</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { margin: 0; padding: 0; overflow: hidden; }
    #ar-container { position: relative; width: 100vw; height: 100vh; }
  </style>
  <script type="importmap">
    {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.141.0/build/three.module.js",
        "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.141.0/examples/jsm/",
        "mind-ar": "https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-three.prod.js"
      }
    }
  </script>
</head>
<body>
  <div id="ar-container"></div>

  <script>
   // Ініціалізація MindAR
    // Переконайтеся, що шлях до файлу targets.mind правильний відносно вашого HTML-файлу
    const mindarThree = new window.MINDAR.IMAGE.MindARThree({
      container: document.getElementById('ar-container'),
      imageTargetSrc: '../assets/targets.mind' // Перевірте, чи файл існує за цим шляхом
    });

    // Отримання renderer, scene та camera від MindAR
    const { renderer, scene, camera } = mindarThree;

      // Сцена
      const geometry = new THREE.SphereGeometry(0.6, 32, 32);
      const material = new THREE.MeshBasicMaterial({ color: 0xCCCCCC, transparent: true, opacity: 0.3 });
      const sphere = new THREE.Mesh(geometry, material);
      scene.add(sphere);

      const torusGeometry = new THREE.TorusGeometry(0.4, 0.05, 16, 32);
      const torusMaterial = new THREE.MeshBasicMaterial({ color: 0xFF5733 });
      const torus = new THREE.Mesh(torusGeometry, torusMaterial);
      scene.add(torus);

      // Частинки
      const particleGeometry = new THREE.SphereGeometry(0.03, 16, 16);
      const particleMaterial1 = new THREE.MeshBasicMaterial({ color: 0x00FF00 });
      const particle1 = new THREE.Mesh(particleGeometry, particleMaterial1);
      particle1.position.set(0.35, 0, 0);
      scene.add(particle1);

      const particleMaterial2 = new THREE.MeshBasicMaterial({ color: 0x00FF00 });
      const particle2 = new THREE.Mesh(particleGeometry, particleMaterial2);
      particle2.position.set(-0.35, 0, 0);
      scene.add(particle2);

      // Світло
      const pointLight = new THREE.PointLight(0xFFFFFF, 1.5);
      pointLight.position.set(2, 0, 0);
      scene.add(pointLight);

      const ambientLight = new THREE.AmbientLight(0xFFFFFF, 0.5);
      scene.add(ambientLight);

      // Анімація
      const clock = new THREE.Clock();
      function animate() {
        const delta = clock.getDelta();
        torus.rotation.y += delta * 0.1; // Обертання тора (10 секунд на коло)
        particle1.rotation.y += delta * 0.33; // Обертання частинки 1 (3 секунди)
        particle2.rotation.y -= delta * 0.33; // Обертання частинки 2 (3 секунди)

        // Імітація зіткнення
        const distance = particle1.position.distanceTo(particle2.position);
        if (distance < 0.2) {
          particleMaterial1.color.set(0xFF0000);
          particleMaterial2.color.set(0xFF0000);
        } else {
          particleMaterial1.color.set(0x00FF00);
          particleMaterial2.color.set(0x00FF00);
        }

        renderer.render(scene, camera);
        requestAnimationFrame(animate);
      }

      await mindarThree.start();
      animate();
    };
    start();
  </script>
</body>
</html>
